---
layout: post
category : all
tagline: "Supporting tagline"
tags: [thing, things]
title: "局域网共享.bat"
date: 2011-12-05
---
把下面内容复制保存为（局域网共享.bat），双击运行
此文件用于WinXP设置局域网共享，方便快捷，设置后重启生效
------------------------------[代码]------------------------------
@echo off
cls
echo.
echo.
echo 1. 开启匿名访问 2.启用验证访问(需要输入用户名密码) 3.关闭共享 4.返回
echo.
echo.
set choice=
set /p choice= ● 请选择‖
if /i &quot;%choice%&quot;==&quot;1&quot; goto share1
if /i &quot;%choice%&quot;==&quot;2&quot; goto share2
if /i &quot;%choice%&quot;==&quot;3&quot; goto share3
if /i &quot;%choice%&quot;==&quot;4&quot; goto end
goto share
:share1
cls
net user Guest /active:yes
echo Windows Registry Editor Version 5.00 &gt;share.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Lsa] &gt;&gt;share.reg
echo &quot;restrictanonymous&quot;=dword:00000000 &gt;&gt;share.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;share.reg
echo &quot;restrictanonymous&quot;=dword:00000000 &gt;&gt;share.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;share.reg
echo &quot;limitblankpassworduse&quot;=dword:00000000 &gt;&gt;share.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Lsa] &gt;&gt;share.reg
echo &quot;limitblankpassworduse&quot;=dword:00000000 &gt;&gt;share.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;share.reg
echo &quot;forceguest&quot;=dword:00000001 &gt;&gt;share.reg
echo [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{75048700-EF1F-11D0-9888-006097DEACF9}\Count] &gt;&gt;share.reg
echo &quot;HRZR_EHAPCY&quot;=hex:0C,00,00,00,26,00,00,00,F0,FB,E5,52,64,95,C6,01 &gt;&gt;share.reg
echo &quot;HRZR_EHAPCY:&quot;P:\JVAQBJF\flfgrz32\sverjnyy.pcy&quot;,Jvaqbjf 防火墙&quot;=hex:0C,00,00,00,08,00,00,00,F0,FB,E5,52,64,95,C6,01 &gt;&gt;share.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List] &gt;&gt;share.reg
echo &quot;445:TCP&quot;=&quot;445:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22005&quot; &gt;&gt;share.reg
echo &quot;137:UDP&quot;=&quot;137:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22001&quot; &gt;&gt;share.reg
echo &quot;138:UDP&quot;=&quot;138:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22002&quot; &gt;&gt;share.reg
echo &quot;139:TCP&quot;=&quot;139:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22004&quot; &gt;&gt;share.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Epoch] &gt;&gt;share.reg
echo &quot;Epoch&quot;=dword:000001ED &gt;&gt;share.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Print\Providers] &gt;&gt;share.reg
echo &quot;LogonTime&quot;=hex:E8,31,8E,4F,64,95,C6,01 &gt;&gt;share.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List] &gt;&gt;share.reg
echo &quot;445:TCP&quot;=&quot;445:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22005&quot; &gt;&gt;share.reg
echo &quot;137:UDP&quot;=&quot;137:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22001&quot; &gt;&gt;share.reg
echo &quot;138:UDP&quot;=&quot;138:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22002&quot; &gt;&gt;share.reg
echo &quot;139:TCP&quot;=&quot;139:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22004&quot; &gt;&gt;share.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\SharedAccess\Epoch] &gt;&gt;share.reg
echo &quot;Epoch&quot;=dword:000001ED &gt;&gt;share.reg
regedit /s share.reg
del share.reg
echo.
echo.
echo √. 局域网匿名访问已开启ゞ
echo 注意：本机要重启后才会生效。
echo ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
echo.
pause &amp; goto logon
:end
goto logon
:share2
cls
net user Guest /active:no
echo Windows Registry Editor Version 5.00 &gt;usershare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Lsa] &gt;&gt;usershare.reg
echo &quot;restrictanonymous&quot;=dword:00000000 &gt;&gt;usershare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;usershare.reg
echo &quot;restrictanonymous&quot;=dword:00000000 &gt;&gt;usershare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;usershare.reg
echo &quot;limitblankpassworduse&quot;=dword:00000000 &gt;&gt;usershare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Lsa] &gt;&gt;usershare.reg
echo &quot;limitblankpassworduse&quot;=dword:00000000 &gt;&gt;usershare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;usershare.reg
echo &quot;forceguest&quot;=dword:00000000 &gt;&gt;usershare.reg
echo [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{75048700-EF1F-11D0-9888-006097DEACF9}\Count] &gt;&gt;usershare.reg
echo &quot;HRZR_EHAPCY&quot;=hex:0C,00,00,00,26,00,00,00,F0,FB,E5,52,64,95,C6,01 &gt;&gt;usershare.reg
echo &quot;HRZR_EHAPCY:&quot;P:\JVAQBJF\flfgrz32\sverjnyy.pcy&quot;,Jvaqbjf 防火墙&quot;=hex:0C,00,00,00,08,00,00,00,F0,FB,E5,52,64,95,C6,01 &gt;&gt;usershare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List] &gt;&gt;usershare.reg
echo &quot;445:TCP&quot;=&quot;445:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22005&quot; &gt;&gt;usershare.reg
echo &quot;137:UDP&quot;=&quot;137:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22001&quot; &gt;&gt;usershare.reg
echo &quot;138:UDP&quot;=&quot;138:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22002&quot; &gt;&gt;usershare.reg
echo &quot;139:TCP&quot;=&quot;139:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22004&quot; &gt;&gt;usershare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Epoch] &gt;&gt;usershare.reg
echo &quot;Epoch&quot;=dword:000001ED &gt;&gt;usershare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Print\Providers] &gt;&gt;usershare.reg
echo &quot;LogonTime&quot;=hex:E8,31,8E,4F,64,95,C6,01 &gt;&gt;usershare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List] &gt;&gt;usershare.reg
echo &quot;445:TCP&quot;=&quot;445:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22005&quot; &gt;&gt;usershare.reg
echo &quot;137:UDP&quot;=&quot;137:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22001&quot; &gt;&gt;usershare.reg
echo &quot;138:UDP&quot;=&quot;138:UDP:LocalSubNet:Enabled:@xpsp2res.dll,-22002&quot; &gt;&gt;usershare.reg
echo &quot;139:TCP&quot;=&quot;139:TCP:LocalSubNet:Enabled:@xpsp2res.dll,-22004&quot; &gt;&gt;usershare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\SharedAccess\Epoch] &gt;&gt;usershare.reg
echo &quot;Epoch&quot;=dword:000001ED &gt;&gt;usershare.reg
regedit /s usershare.reg
del usershare.reg
echo.
echo.
echo √. 局域网验证访问已开启ゞ
echo 友情提示：无需重启，其它机现在就可以访问本机了。
echo ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
echo.
pause &amp; goto logon
:end
goto logon
:share3
cls
net user Guest /active:no
echo Windows Registry Editor Version 5.00 &gt;offshare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Lsa] &gt;&gt;offshare.reg
echo &quot;restrictanonymous&quot;=dword:00000001 &gt;&gt;offshare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;offshare.reg
echo &quot;restrictanonymous&quot;=dword:00000001 &gt;&gt;offshare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;offshare.reg
echo &quot;limitblankpassworduse&quot;=dword:00000001 &gt;&gt;offshare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Lsa] &gt;&gt;offshare.reg
echo &quot;limitblankpassworduse&quot;=dword:00000001 &gt;&gt;offshare.reg
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] &gt;&gt;offshare.reg
echo &quot;forceguest&quot;=dword:00000001 &gt;&gt;offshare.reg
echo [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{75048700-EF1F-11D0-9888-006097DEACF9}\Count] &gt;&gt;offshare.reg
echo &quot;HRZR_EHAPCY&quot;=hex:0C,00,00,00,2A,00,00,00,90,AF,A4,87,A4,95,C6,01 &gt;&gt;offshare.reg
echo &quot;HRZR_EHAPCY:&quot;P:\JVAQBJF\flfgrz32\sverjnyy.pcy&quot;,Jvaqbjf 防火墙&quot;=hex:0C,00,00,00,13,00,00,00,90,AF,A4,87,A4,95,C6,01 &gt;&gt;offshare.reg echo [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\RNG] &gt;&gt;offshare.reg
echo &quot;Seed&quot;=hex:AC,6F,9A,2B,11,64,44,68,EC,90,1B,76,72,A7,0A,14,4C,79,37,BB,FD,BD,70,B2,B2,58,D5,B5,89,5C,B6,4E,3B,18,A5,26,46,BC,3E,6A,30,A4,7D,A0,56,E6,6A,B5,57,3A,BF,A1,CD,CA,B6,64,4C,F9,0E,D2,64,ED,86,1F,61,F6,D1,01,0B,7C,8D,BD,73,10,C8,4E,57,93,4E,90 &gt;&gt;offshare.regecho [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List] &gt;&gt;offshare.reg
echo &quot;445:TCP&quot;=&quot;445:TCP:LocalSubNet:Disabled:@xpsp2res.dll,-22005&quot; &gt;&gt;offshare.reg
echo &quot;137:UDP&quot;=&quot;137:UDP:LocalSubNet:Disabled:@xpsp2res.dll,-22001&quot; &gt;&gt;offshare.reg
echo &quot;138:UDP&quot;=&quot;138:UDP:LocalSubNet:Disabled:@xpsp2res.dll,-22002&quot; &gt;&gt;offshare.reg
echo &quot;139:TCP&quot;=&quot;139:TCP:LocalSubNet:Disabled:@xpsp2res.dll,-22004&quot; &gt;&gt;offshare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Epoch] &gt;&gt;offshare.reg
echo &quot;Epoch&quot;=dword:000001FC &gt;&gt;offshare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\GloballyOpenPorts\List] &gt;&gt;offshare.reg
echo &quot;445:TCP&quot;=&quot;445:TCP:LocalSubNet:Disabled:@xpsp2res.dll,-22005&quot; &gt;&gt;offshare.reg
echo &quot;137:UDP&quot;=&quot;137:UDP:LocalSubNet:Disabled:@xpsp2res.dll,-22001&quot; &gt;&gt;offshare.reg
echo &quot;138:UDP&quot;=&quot;138:UDP:LocalSubNet:Disabled:@xpsp2res.dll,-22002&quot; &gt;&gt;offshare.reg
echo &quot;139:TCP&quot;=&quot;139:TCP:LocalSubNet:Disabled:@xpsp2res.dll,-22004&quot; &gt;&gt;offshare.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\SharedAccess\Epoch] &gt;&gt;offshare.reg
echo &quot;Epoch&quot;=dword:000001FC &gt;&gt;offshare.reg
regedit /s offshare.reg
del offshare.reg
echo.
echo.
echo √. 已关闭局域网共享ゞ
echo 友情提示：不必重启，设置已生效。
echo ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
echo.
pause &amp; goto logon
------------------------------[代码]------------------------------